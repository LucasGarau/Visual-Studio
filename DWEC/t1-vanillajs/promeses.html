<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        //XMLHTPrequest ---> Api Fetch (Promises javascript)

        //PROMISES

        const x = new Promise(function (res, rej) {

        })

        //x estara en estat "Pending2 fins que crida a "resolve" o "reject" 

        //Quan acaba es crida al metode then si ha finalitzat be resolve o catch si no ha anat be (reject)

        const wait = new Promise(function (resolve, reject) {
            setTimeout(function () {
                resolve("Ha acabat el resolve")
            }, 5000)
        }).then(function (valor) {
            console.log("Ha entrat al then:", valor);
        }).catch((valor) => console.log("Error", valor));

        console.log(wait);
        setTimeout(function () {
            console.log(wait)

        }, 8000);


        //Ajax-fetch (ES6)
        const peticio1 = fetch("http://esliceu.codiblau.com/exercicis/ud5/color?min=10&max=20") 

        .then(function (resposta1) {
            console.log(resposta1);
            return resposta1.json(); //Si triem .json  
        }).then(function (resposta2) { //Aixo ya es un objecte javascript per que ya el em parsecjat.
            console.log(resposta2);
        });

        console.log("peticio1:" + peticio1);


        fetch("http://esliceu.codiblau.com/exercicis/ud5/color?min=10&max=20")
        .then((r) => r.json())
        .then((resposta)=>{
            console.log("Resposta 2", resposta)
        });
/*
        fetch("http://esliceu.codiblau.com/exercicis/ud5/color?min=10&max=20"),{
            method: "POST",
            body:"min=10&max=20",
            headers:{
                "Content-type" : "aplication/x-www-form-urlencode"
            }
        }
        .then((r) => r.json())
        .then((resposta)=>{
            console.log("Resposta 2", resposta)
        });
*/

/*
 Crear una taula d'usuaris amb el resultat de
 http://esliceu.codiblau.com/exercicis/ud5/usuaris/list

 Ho heu de cridar amb Get y returno un json
*/

fetch("http://esliceu.codiblau.com/exercicis/ud5/usuaris/list")
        .then((r) => r.json())
        .then((resposta)=>{
            console.log("Resposta 2", resposta)
        });

    </script>
</body>

</html>